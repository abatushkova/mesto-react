(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{11:function(e,t,a){e.exports=a.p+"static/media/logo.5746c0f0.svg"},13:function(e,t,a){e.exports=a(19)},18:function(e,t,a){},19:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(10),s=a.n(o),i=(a(18),a(12)),l=a(1),c=a(11),u=a.n(c);var p=function(){return r.a.createElement("header",{className:"header page__section"},r.a.createElement("img",{src:u.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0441\u0430\u0439\u0442\u0430 \u041c\u0435\u0441\u0442\u043e",className:"header__logo"}))},m=r.a.createContext(null);var d=function(e){var t=e.card,a=Object(n.useContext)(m),o=t.likes.some((function(e){return e._id===a._id})),s="elements__like-btn ".concat(o&&"elements__like-btn_active"),i=t.owner._id===a._id&&r.a.createElement("button",{type:"button",className:"elements__delete-btn",title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",onClick:function(){e.onCardDelete(t)}});return r.a.createElement("div",{className:"elements__item"},i,r.a.createElement("img",{src:t.link,alt:t.name,className:"elements__img",onClick:function(){e.onCardClick(t)}}),r.a.createElement("div",{className:"elements__info"},r.a.createElement("h2",{className:"elements__title"},t.name),r.a.createElement("div",{className:"elements__like"},r.a.createElement("button",{type:"button",className:s,title:"\u041c\u043d\u0435 \u043d\u0440\u0430\u0432\u0438\u0442\u0441\u044f",onClick:function(){e.onCardLike(t)}}),r.a.createElement("span",{className:"elements__like-counter"},t.likes.length))))};var f=function(e){var t=Object(n.useContext)(m);return r.a.createElement("main",{className:"container page__section"},r.a.createElement("section",{className:"profile container__profile"},r.a.createElement("div",{className:"profile__avatar"},r.a.createElement("img",{src:t.avatar,alt:t.name,className:"profile__img"}),r.a.createElement("button",{type:"button",className:"profile__update-av-btn",title:"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",onClick:e.onEditAvatar})),r.a.createElement("div",{className:"profile__details"},r.a.createElement("h1",{className:"profile__name"},t.name),r.a.createElement("button",{type:"button",className:"profile__edit-btn",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",onClick:e.onEditProfile}),r.a.createElement("p",{className:"profile__info"},t.about)),r.a.createElement("button",{type:"button",className:"profile__add-btn",title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u044e",onClick:e.onAddCard})),r.a.createElement("section",{className:"elements"},e.cards.map((function(t){return r.a.createElement(d,{key:t._id,card:t,onCardLike:e.onCardLike,onCardClick:e.onCardClick,onCardDelete:e.onCardDelete})}))))};var _=function(){return r.a.createElement("footer",{className:"footer page__section"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))};var h=function(e){return r.a.createElement("button",{type:"button",className:"popup__close-btn",title:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:e.closeHandler})};var v=function(e){var t=Object(n.useRef)(null);Object(n.useEffect)((function(){return document.addEventListener("click",a,!1),document.addEventListener("keydown",o,!1),function(){document.removeEventListener("click",a,!1),document.removeEventListener("keydown",o,!1)}}));var a=function(a){t.current&&!t.current.contains(a.target)&&e.closeHandler()},o=function(t){t.key&&"Escape"===t.key&&e.closeHandler()};return r.a.createElement("div",{className:e.className,ref:t},e.children)};var b=function(e){return e.isOpen?r.a.createElement("div",{className:"popup popup_type_".concat(e.name," popup_opened")},r.a.createElement(v,{className:"popup__container",closeHandler:e.onClose},r.a.createElement("h2",{className:"popup__title"},e.title),r.a.createElement("form",{className:"popup__form",name:e.name,id:"".concat(e.name,"-form"),noValidate:!0,onSubmit:e.onSubmit},e.children),r.a.createElement(h,{closeHandler:e.onClose}))):r.a.createElement("div",{className:"popup popup_type_".concat(e.name)})};var C=function(e){var t="popup__submit-btn ".concat(e.isDisabled?"popup__submit-btn_disabled":"");return r.a.createElement("button",{type:"submit",className:t,disabled:e.isDisabled},e.children)};var E=function(e){var t=Object(n.useContext)(m),a=Object(n.useState)(""),o=Object(l.a)(a,2),s=o[0],i=o[1],c=Object(n.useState)(""),u=Object(l.a)(c,2),p=u[0],d=u[1],f=Object(n.useState)({inputClass:"",errorClass:"",errorMsg:""}),_=Object(l.a)(f,2),h=_[0],v=_[1],E=Object(n.useState)({inputClass:"",errorClass:"",errorMsg:""}),g=Object(l.a)(E,2),O=g[0],j=g[1],k=Object(n.useState)(!0),N=Object(l.a)(k,2),y=N[0],S=N[1],L=Object(n.useState)(!1),M=Object(l.a)(L,2),P=M[0],w=M[1];return Object(n.useEffect)((function(){i(t.name),d(t.about)}),[t]),r.a.createElement(b,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:e.isOpen,onClose:function(){e.onClose(),i(t.name),d(t.about),S(!0),v({inputClass:"",errorClass:"",errorMsg:""}),j({inputClass:"",errorClass:"",errorMsg:""})},onSubmit:function(t){t.preventDefault(),w(!0),e.onUpdateUser({name:s,about:p}).finally((function(){S(!0),w(!1)}))}},r.a.createElement("label",{className:"popup__label",htmlFor:"name-input"},r.a.createElement("input",{type:"text",name:"name",id:"name-input",className:"popup__input ".concat(h.inputClass),placeholder:"\u0418\u043c\u044f",value:s,onChange:function(e){var t=e.target;i(t.value),t.validity.valid?(v({inputClass:"",errorClass:"",errorMsg:""}),S(!0)):(v({inputClass:"popup__input_type_error",errorClass:"popup__error_visible",errorMsg:t.validationMessage}),S(!1))},pattern:"[a-zA-Z\u0430-\u044f\u0410-\u042f\u0451\u0401\\s-]+",minLength:2,maxLength:40,required:!0}),r.a.createElement("span",{className:"popup__error ".concat(h.errorClass),id:"name-input-error"},h.errorMsg)),r.a.createElement("label",{className:"popup__label",htmlFor:"about-input"},r.a.createElement("input",{type:"text",name:"about",id:"about-input",className:"popup__input ".concat(O.inputClass),placeholder:"\u041e \u0441\u0435\u0431\u0435",value:p,onChange:function(e){var t=e.target;d(t.value),t.validity.valid?(j({inputClass:"",errorClass:"",errorMsg:""}),S(!0)):(j({inputClass:"popup__input_type_error",errorClass:"popup__error_visible",errorMsg:t.validationMessage}),S(!1))},minLength:2,maxLength:200,required:!0}),r.a.createElement("span",{className:"popup__error ".concat(O.errorClass),id:"about-input-error"},O.errorMsg)),r.a.createElement(C,{isDisabled:!y},P?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))},g=a(2),O=a(3),j=a(8),k=a(7),N=function(e){Object(j.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(g.a)(this,a),(n=t.call(this,e)).handleChange=function(){var e=n.avatar.current;e.validity.valid?(n.setState({isFormValid:!0}),n.hideInputError()):(n.setState({isFormValid:!1}),n.showInputError(e))},n.showInputError=function(e){n.setState({inputClass:"popup__input_type_error",errorClass:"popup__error_visible",errorMsg:e.validationMessage})},n.hideInputError=function(){n.setState({inputClass:"",errorClass:"",errorMsg:""})},n.handleClose=function(){n.props.onClose(),n.setState({isFormValid:!1}),n.hideInputError()},n.handleSubmit=function(e){e.preventDefault(),n.setState({isLoading:!0}),n.props.onUpdateAvatar({avatar:n.avatar.current.value}).finally((function(){n.setState({isFormValid:!1,isLoading:!1}),n.hideInputError()}))},n.avatar=r.a.createRef(),n.state={inputClass:"",errorClass:"",errorMsg:"",isFormValid:!1,isLoading:!1},n}return Object(O.a)(a,[{key:"render",value:function(){return r.a.createElement(b,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:this.props.isOpen,onClose:this.handleClose,onSubmit:this.handleSubmit},r.a.createElement("label",{className:"popup__label",htmlFor:"avatar-input"},r.a.createElement("input",{type:"url",name:"avatar",className:"popup__input ".concat(this.state.inputClass),id:"avatar-input",ref:this.avatar,onChange:this.handleChange,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430",required:!0}),r.a.createElement("span",{className:"popup__error ".concat(this.state.errorClass),id:"avatar-input-error"},this.state.errorMsg)),r.a.createElement(C,{isDisabled:!this.state.isFormValid},this.state.isLoading?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))}}]),a}(r.a.Component),y=a(4),S=function(e){Object(j.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(g.a)(this,a),(n=t.call(this,e)).handleChange=function(e){var t=n[e.target.name].current,a=t.name,r=Object(y.a)({},n.state.formProps),o=Object(y.a)({},r[a]),s=!0;for(var i in r)s=s&&n[i].current.validity.valid;t.validity.valid?n.hideInputError(o):n.showInputError(t,o),r[a]=o,n.setState({formProps:r,isFormValid:s})},n.showInputError=function(e,t){t.inputClass="popup__input_type_error",t.errorClass="popup__error_visible",t.errorMsg=e.validationMessage},n.hideInputError=function(e){e.inputClass="",e.errorClass="",e.errorMsg=""},n.handleClose=function(){var e=n.state.formProps;for(var t in n.props.onClose(),n.setState({isFormValid:!1}),e)n.hideInputError(e[t])},n.handleSubmit=function(e){e.preventDefault(),n.setState({isLoading:!0});var t=n.state.formProps;n.props.onAddCardSubmit({name:n.title.current.value,link:n.src.current.value}).finally((function(){for(var e in n.setState({isFormValid:!1,isLoading:!1}),t)n.hideInputError(t[e])}))},n.title=r.a.createRef(),n.src=r.a.createRef(),n.state={formProps:{title:{inputClass:"",errorClass:"",errorMsg:""},src:{inputClass:"",errorClass:"",errorMsg:""}},isFormValid:!1,isLoading:!1},n}return Object(O.a)(a,[{key:"render",value:function(){return r.a.createElement(b,{name:"card",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:this.props.isOpen,onClose:this.handleClose,onSubmit:this.handleSubmit},r.a.createElement("label",{className:"popup__label",htmlFor:"title-input"},r.a.createElement("input",{type:"text",name:"title",className:"popup__input ".concat(this.state.formProps.title.inputClass),id:"title-input",ref:this.title,onChange:this.handleChange,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:1,maxLength:30,required:!0}),r.a.createElement("span",{className:"popup__error ".concat(this.state.formProps.title.errorClass),id:"title-input-error"},this.state.formProps.title.errorMsg)),r.a.createElement("label",{className:"popup__label",htmlFor:"src-input"},r.a.createElement("input",{type:"url",name:"src",className:"popup__input ".concat(this.state.formProps.src.inputClass),id:"src-input",ref:this.src,onChange:this.handleChange,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430",required:!0}),r.a.createElement("span",{className:"popup__error ".concat(this.state.formProps.src.errorClass),id:"src-input-error"},this.state.formProps.src.errorMsg)),r.a.createElement(C,{isDisabled:!this.state.isFormValid},this.state.isLoading?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"))}}]),a}(r.a.Component);var L=function(e){var t=e.card;return r.a.createElement(b,{name:"confirm",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onCardDeleteConfirm(t._id)}},r.a.createElement(C,null,"\u0414\u0430"))};var M=function(e){var t=e.card;return e.isOpen?r.a.createElement("div",{className:"popup popup_type_img popup_opened"},r.a.createElement(v,{className:"popup__img-wrapper",closeHandler:e.onClose},r.a.createElement("img",{src:t.link,alt:t.name,className:"popup__img"}),r.a.createElement("p",{className:"popup__img-title"},t.name),r.a.createElement(h,{closeHandler:e.onClose}))):r.a.createElement("div",{className:"popup popup_type_img"})},P=new(function(){function e(t){Object(g.a)(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers}return Object(O.a)(e,[{key:"_fetch",value:function(e,t){return fetch(this._baseUrl+e,Object(y.a)(Object(y.a)({},t),{},{headers:this._headers,body:JSON.stringify(t.body)})).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"getUserInfo",value:function(){return this._fetch("/users/me",{method:"GET"})}},{key:"getCardList",value:function(){return this._fetch("/cards",{method:"GET"})}},{key:"postCard",value:function(e){var t=e.name,a=e.link;return this._fetch("/cards",{method:"POST",body:{name:t,link:a}})}},{key:"changeCardLikeStatus",value:function(e,t){return this._fetch("/cards/likes/"+e,{method:t?"PUT":"DELETE"})}},{key:"deleteCard",value:function(e){return this._fetch("/cards/"+e,{method:"DELETE"})}},{key:"setUserInfo",value:function(e){var t=e.name,a=e.about;return this._fetch("/users/me",{method:"PATCH",body:{name:t,about:a}})}},{key:"setUserAvatar",value:function(e){var t=e.avatar;return this._fetch("/users/me/avatar",{method:"PATCH",body:{avatar:t}})}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-12",headers:{authorization:"bd0f2499-7585-4f83-9366-da3fa3857f94","Content-Type":"application/json"}});var w=function(){var e=Object(n.useState)(null),t=Object(l.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)(!1),c=Object(l.a)(s,2),u=c[0],d=c[1],h=Object(n.useState)(!1),v=Object(l.a)(h,2),b=v[0],C=v[1],g=Object(n.useState)(!1),O=Object(l.a)(g,2),j=O[0],k=O[1],y=Object(n.useState)(!1),w=Object(l.a)(y,2),D=w[0],I=w[1],U=Object(n.useState)(!1),F=Object(l.a)(U,2),A=F[0],x=F[1],V=Object(n.useState)(null),H=Object(l.a)(V,2),T=H[0],q=H[1],R=Object(n.useState)([]),J=Object(l.a)(R,2),z=J[0],B=J[1];Object(n.useEffect)((function(){P.getUserInfo().then((function(e){return o(e)})).catch((function(e){return console.error(e)}))}),[]),Object(n.useEffect)((function(){P.getCardList().then((function(e){return B(e)})).catch((function(e){return console.error(e)}))}),[]);var G=function(){d(!1),C(!1),k(!1),I(!1),x(!1),q(null)};return a?r.a.createElement(m.Provider,{value:a},r.a.createElement("div",{className:"page__content"},r.a.createElement(p,null),r.a.createElement(f,{onEditAvatar:function(){d(!0)},onEditProfile:function(){C(!0)},onAddCard:function(){k(!0)},onCardClick:function(e){q(e),I(!0)},cards:z,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===a._id}));P.changeCardLikeStatus(e._id,!t).then((function(t){var a=z.map((function(a){return a._id===e._id?t:a}));B(a)})).catch((function(e){return console.error(e)}))},onCardDelete:function(e){q(e),x(!0)}}),r.a.createElement(_,null),r.a.createElement(N,{isOpen:u,onClose:G,onUpdateAvatar:function(e){var t=e.avatar;return P.setUserAvatar({avatar:t}).then((function(e){o(e),G()})).catch((function(e){return console.error(e)}))}}),r.a.createElement(E,{isOpen:b,onClose:G,onUpdateUser:function(e){var t=e.name,a=e.about;return P.setUserInfo({name:t,about:a}).then((function(e){o(e),G()})).catch((function(e){return console.error(e)}))}}),r.a.createElement(S,{isOpen:j,onClose:G,onAddCardSubmit:function(e){var t=e.name,a=e.link;return P.postCard({name:t,link:a}).then((function(e){B([e].concat(Object(i.a)(z))),G()})).catch((function(e){return console.error(e)}))}}),r.a.createElement(L,{card:T,isOpen:A,onClose:G,onCardDeleteConfirm:function(e){P.deleteCard(e).then((function(t){var a=z.filter((function(a){return a._id===e?null:t}));B(a),G()})).catch((function(e){return console.error(e)}))}}),r.a.createElement(M,{card:T,isOpen:D,onClose:G}))):null};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(w,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[13,1,2]]]);
//# sourceMappingURL=main.f4ad5b50.chunk.js.map